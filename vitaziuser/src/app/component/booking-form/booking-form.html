<ion-content class="main-bg">
  <div class="container">

    <div class="header-section">
      <h2>üìÖ ƒêƒÉng k√Ω kh√°m b·ªánh</h2>
    </div>

    <div class="card-section">
      <div class="form-row">
        <div class="form-group">
          <label>Ph√≤ng kh√°m</label>
          <div class="custom-select">
            <ion-select [(ngModel)]="selectedClinicId" (ionChange)="onClinicChange()" placeholder="Ch·ªçn ph√≤ng kh√°m"
              interface="popover">
              <ion-select-option *ngFor="let c of clinics" [value]="c.id">{{ c.clinicName }}</ion-select-option>
            </ion-select>
          </div>
        </div>

        <div class="form-group">
          <label>Chuy√™n khoa</label>
          <div class="custom-select" [class.disabled]="!selectedClinicId">
            <ion-select [(ngModel)]="selectedDepartmentId" (ionChange)="onDepartmentChange()" placeholder="Ch·ªçn khoa"
              interface="popover" [disabled]="!selectedClinicId">
              <ion-select-option *ngFor="let d of departments" [value]="d.id">{{ d.departmentName }}</ion-select-option>
            </ion-select>
          </div>
        </div>
      </div>
    </div>

    <div class="date-section" *ngIf="selectedDepartmentId">
      <div class="date-scroller">
        <div class="date-card" *ngFor="let day of weekDays" [class.active]="selectedDate === day.fullDate"
          (click)="selectDate(day)">
          <span class="day-name">{{ day.dayName }}</span>
          <span class="day-number">{{ day.dayNumber }}</span>
          <span class="month-name">{{ day.displayMonth }}</span>
        </div>
      </div>
    </div>

    <div class="time-section" *ngIf="selectedDepartmentId">
      <h4>üïí Ca kh√°m c√≤n tr·ªëng</h4>

      <div class="time-grid" *ngIf="schedules.length > 0; else noSchedule">
        <button class="time-chip" *ngFor="let s of schedules" [class.selected]="selectedSchedule?.id === s.id"
          (click)="selectTimeSlot(s)">
          {{ formatTime(s.startTime) }} - {{ formatTime(s.endTime) }}
        </button>
      </div>

      <ng-template #noSchedule>
        <p class="empty-msg">Kh√¥ng c√≥ l·ªãch kh√°m n√†o trong ng√†y {{selectedDate}}</p>
      </ng-template>
    </div>

    <div class="info-section" *ngIf="selectedSchedule">
      <h4>Th√¥ng tin ng∆∞·ªùi kh√°m</h4>

      <div class="input-box">
        <label>H·ªç v√† T√™n</label>
        <input type="text" [(ngModel)]="patientName" placeholder="Nguy·ªÖn VƒÉn A">
      </div>

      <div class="input-box">
        <label>S·ªë ƒëi·ªán tho·∫°i</label>
        <input type="tel" [(ngModel)]="patientPhone" placeholder="09xxxx">
      </div>

      <div class="input-box">
        <label>Email (Tu·ª≥ ch·ªçn)</label>
        <input type="email" [(ngModel)]="patientEmail" placeholder="email@example.com">
      </div>

      <div class="input-box">
        <label>L√Ω do kh√°m</label>
        <input type="text" [(ngModel)]="description" placeholder="Tri·ªáu ch·ª©ng...">
      </div>

      <button class="btn-submit" (click)="onSubmit()">X√°c nh·∫≠n ƒê·∫∑t l·ªãch</button>
    </div>

  </div>
</ion-content>